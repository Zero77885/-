# VIM常用语法

yy 复制光标当前一行

y 数字y 复制一段（从光标当前行到后n行）

p 箭头移动到目的行粘贴

u 撤销上一步

dd 删除光标当前行

d数字d 删除光标（含）后多少行

x 剪切一个字母(当前光标)，相当于del

X  剪切一个字母(当前光标的前一个)，相当于Backspace

yw 复制一个词

dw 删除一个词

shift+6(^) 移动到行头

shift+4($) 移动到行尾

1+shift+g 移动到页头，数字

shift+g 移动到页尾

数字N+shift+g 移动到目标行





# 进入编辑模式

i 当前光标前

a 当前光标后

o 当前光标行的下一行

I (大写i)光标所在行最前

A光标所在行最后

O 当前光标行的上一行





# 指令模式

:w 保存

:q 退出

:! 强制执行

/要查找的词 n 查找下一个，N 往上查找

:noh 取消高亮显示

:set nu 显示行号

:set nonu 关闭行号

:%s/old/new/g 替换内容  /g global替换匹配到的所有内容

 

# 查看当前网络IP

ifconfig



# 重启网络

service network restart

# 查看IP配置文件

vim /etc/sysconfig/network-scripts/ifcfg-ens33

# 修改主机名称

vim /etc/hostname

# 关闭打开防火墙

systemctl start | stop | restart | status  firewalld 服务名

# 设置后台服务的自启配置

systemctl list-unit-files     （功能描述：查看服务开机启动状态）

systemctl disable service_name （功能描述：关掉指定服务的自动启动）

systemctl enable service_name  （功能描述：开启指定服务的自动启动）

# 关机重启命令

sync           （功能描述：将数据由内存同步到硬盘中）

halt        （功能描述：关闭系统，等同于shutdown -h now 和 poweroff）

reboot          （功能描述：就是重启，等同于 shutdown -r now）

shutdown [选项] 时间

## 选项:

-h  -h=halt关机

-r -r=reboot重启

now 立刻关机

# man 获得帮助信息

man [命令或配置文件]

## 命令或配置文件

NAME  命令的名称和单行描述

SYNOPSIS 怎样使用命令

DESCRIPTION 命令功能的深入讨论

 EXAMPLES 怎样使用命令的例子

SEE ALSO 相关主题（通常是手册页）

# 常用快捷键

ctrl + c  停止进程

ctrl+l 清屏；

ctrl + q 退出

善于用tab键 提示(更重要的是可以防止敲错)

上下键 查找执行过的命令

 ctrl +u 清除当前敲的命令

# 显示当前工作目录的绝对路径

pwd

# 列出目录的内容

ls 或 ll

选项

-a 全部的文件，连同隐藏档( 开头为 . 的文件) 一起列出来(常用)

-l 长数据串列出，包含文件的属性与权限等等数据；(常用)

# 切换目录

cd [参数]

参数:

cd 绝对路径 切换路径

cd相对路径 切换路径

cd ~或者cd  回到自己的家目录

cd - 回到上一次所在目录

 cd .. 回到当前目录的上一级目录

cd -P 跳转到实际物理路径，而非快捷方式路径

# 创建一个新的目录

mkdir [选项] 要创建的目录

选项

-p  创建多层目录

#  创建空文件

touch 文件名称

# 复制文件或目录

cp [选项] source dest             （功能描述：复制source文件到dest）

选项:

-r  递归复制整个文件夹

强制覆盖不提示的方法：\cp

# 删除文件或目录

rm [选项] deleteFile          （功能描述：递归删除目录中所有内容）

选项:

-r 递归删除目录中所有内容

-f 强制执行删除操作，而不提示用于进行确认

-v 显示指令的详细执行过程

#  移动文件与目录或重命名

 mv oldNameFile newNameFile   （功能描述：重命名）

mv /temp/movefile /targetFolder  （功能描述：移动文件）

# 查看文件内容

cat [选项] 要查看的文件

选项:

-n 显示所有行的行号，包括空行。

# 件内容分屏查看器

more 要查看的文件

操作:

空格键 (space) 代表向下翻一页；

Enter 代表向下翻『一行』；

q 代表立刻离开 more ，不再显示该文件内容。

Ctrl+F 向下滚动一屏

Ctrl+B 返回上一屏

= 输出当前行的行号

:f 输出文件名和当前行的行号

# 分屏显示文件内容

less 要查看的文件

操作:

空格键  向下翻动一页；

[pagedown] 向下翻动一页

[pageup] 向上翻动一页；

/字串 向下搜寻『字串』的功能；n：向下查找；N：向上查找；

?字串 向上搜寻『字串』的功能；n：向上查找；N：向下查找

q  离开 less 这个程序；

#   输出文件尾部内容

tail 文件       （功能描述：查看文件尾部10行内容）

tail -n 5 文件  （功能描述：查看文件尾部5行内容，5可以是任意行数）

tail -f 文件    （功能描述：实时追踪该文档的所有更新）

-n<行数> 输出文件尾部n行内容

-f 显示文件最新追加的内容，监视文件变化

# 输出内容到控制台

echo [选项] [输出内容]

选项:

-e： 支持反斜线控制的字符转换

\\ \ 输出\本身

\n  换行符

# 输出重定向和  追加

ls -l > 文件         （功能描述：列表的内容写入文件a.txt中（覆盖写））

ls -al >> 文件          （功能描述：列表的内容追加到文件aa.txt的末尾）

cat 文件1 > 文件2        （功能描述：将文件1的内容覆盖到文件2）

echo “内容” >> 文件   （功能描述：将内容追加到文件中）

# 软链接

ln -s [原文件或目录] [软链接名]    （功能描述：给原文件创建一个软链接）

# 查看已经执行过历史命令

history  

# 时间日期类

date [OPTION]... [+FORMAT]

选项:

-d<时间字符串> 显示指定的“时间字符串”表示的时间，而非当前时间

-s<日期时间> 设置系统日期时间



## 显示当前时间

date                         （功能描述：显示当前时间）

date +%Y                     （功能描述：显示当前年份）

date +%m                     （功能描述：显示当前月份）

date +%d                      （功能描述：显示当前是哪一天）

date "+%Y-%m-%d %H:%M:%S"    （功能描述：显示年月日时分秒）

## 显示非当前时间

date -d '1 days ago'        （功能描述：显示前一天时间）

date -d '-1 days ago'    （功能描述：显示明天时间）

## 设置系统时间

date -s 字符串时间

## 用户管理命令

useradd 用户名          （功能描述：添加新用户）

useradd -g 组名 用户名       （功能描述：添加新用户到某个组）

# 设置用户密码

passwd 用户名   （功能描述：设置用户密码）

# 查看用户是否存在

id 用户名

# 切换用户

su 用户名称  （功能描述：切换用户，只能获得用户的执行权限，不能获得环境变量）

su - 用户名称    （功能描述：切换到用户并获得该用户的环境变量及执行权限）

# 删除用户

userdel 用户名      （功能描述：删除用户但保存用户主目录）

userdel -r 用户名     （功能描述：用户和用户主目录，都删除）

选项:

-r  删除用户的同时，删除与用户相关的所有文件。

# 设置普通用户具有root权限

1）修改配置文件

vim /etc/sudoers

visudo

修改 /etc/sudoers 文件，找到下面一行(91行)，在root下面添加一行

```
## Allow root to run any commands anywhere
root    ALL=(ALL)     ALL
atguigu   ALL=(ALL)     ALL
```

或者配置成采用sudo命令时，不需要输入密码

````
## Allow root to run any commands anywhere
root      ALL=(ALL)     ALL
atguigu   ALL=(ALL)     NOPASSWD:ALL
````

修改完毕，现在可以用atguigu帐号登录，然后用命令 sudo ，即可获得root权限进行操作。

# 修改用户

usermod -l 新用户名 老用户名

usermod -d /home/新用户名 -m新用户名

选项

-l  改变用户名

-d 修改家目录



# 新增组

 groupadd 组名

# 删除组

groupdel 组名

# 修改组

groupmod -n 新组名 老组名

# 修改用户组

usermod -g 组名 用户名

-g 指定用户需要加入的用户组 得写id

# 查看创建了哪些组

cat /etc/group

# 文件属性

| 文件类型 |           属主权限           |           属组权限           |         其他用户权限         |
| :------: | :--------------------------: | :--------------------------: | :--------------------------: |
|    0     |  1           2           3   | 4            5             6 | 7            8            9  |
|    d     | r             w           x  | r             w           x  | r             w           x  |
| 目录文件 | 读          写          执行 | 读          写          执行 | 读          写          执行 |

如果没有权限，就会出现减号[ - ]而已。从左至右用0-9这些数字来表示:

-代表文件

 d 代表目录

l 链接文档(link file)

# 改变权限

chmod [{ugoa}{+-=}{rwx}] 文件或目录

如: chmod u+x 文件或者目录

chmod [mode=421 ] [文件或目录]

## 修改整个文件夹里面的所有文件的所有者、所属组、其他用户都具有可读可写可执行权限。

chmod -R 777 文件/目录

# 改变所有者

chown [-R] [最终用户] [文件或目录]      （功能描述：改变文件或者目录的所有者）

# 改变所属组

chgrp [最终用户组] [文件或目录]    （功能描述：改变文件或者目录的所属组）

# 查找文件或者目录

find [搜索范围] [选项]

选项:  

**-name<****查询方式>**  按照指定的文件名查找模式查找文件

-user<查询方式>查找属于指定用户名所有文件

-size<文件大小>按照指定的文件大小查找文件,单位为: 

b —— 块（512字节）

c —— 字节

w —— 字（2字节）

k —— 千字节

M —— 兆字节

G —— 吉字节

# 过滤查找及“|”管道符

管道符，“|”，表示将前一个命令的处理结果输出传递给后面的命令处理。

grep 选项 查找内容 源文件

选项:

-n 显示匹配行及行号。

# 压缩和解压类

## gzip/gunzip压缩

gzip 文件       （功能描述：压缩文件，只能将文件压缩为*.gz文件）

gunzip 文件.gz   （功能描述：解压缩文件命令）

## 打包

tar [选项] XXX.tar.gz 将要打包进去的内容   

选项:

-c 产生.tar打包文件

-v 显示详细信息

-f 指定压缩后的文件名

-z 打包同时压缩

-x 解包.tar文件

### 压缩

tar -zcvf XXX.tar.gz 将要打包进去的内容   

### 解压

tar -zxvf 要解压的文件



# 查看磁盘空间使用情况

df 选项 （功能描述：列出文件系统的整体磁盘使用量，检查文件系统的磁盘空间占用情况）

选项:

-h 以人们较易阅读的 GBytes, MBytes, KBytes 等格式自行显示

# 文件和目录的磁盘使用空间

du  目录/文件（功能描述：显示每个文件和目录的磁盘使用空间）

选项:

-a 显示当前目录下所有的文件目录及子目录大小

# 查看当前系统进程状态

ps -aux | grep xxx     （功能描述：查看系统中所有进程）

ps -ef | grep xxx      （功能描述：可以查看子父进程之间的关系）

选项:

-a 选择所有进程

-u 显示所有用户的所有进程

-x 显示没有终端的进程

# 终止进程

 kill [选项] 进程号      （功能描述：通过进程号杀死进程）

killall 进程名称      （功能描述：通过进程名称杀死进程，也支持通配符，这

选项:

-9 表示强迫进程立即停止

# 查看系统健康状态

top [选项]   

选项

-d 秒数 指定top命令每隔几秒更新。默认是3秒在top命令的交互模式当中可以执行的命令：

-i 使top不显示任何闲置或者僵死进程。

-p 通过指定监控进程ID来仅仅监控某个进程的状态。

操作:

P  以CPU使用率排序，默认就是此项 

M  以内存的使用率排序

N 以PID排序

q 退出top

#  查看服务器总体内存

free -m （功能描述：查看服务器总体内存）

# 显示网络统计信息和端口占用情况

netstat -anp |grep 进程号   （功能描述：查看该进程网络信息）

netstat -nlp |grep 端口号  （功能描述：查看网络端口号占用情况）



# 系统定时任务

1.1.1 crontab 服务管理

重新启动crond服务  **systemctl restart crond**

## 定时任务设置

crontab [选项]

选项:

-e 编辑crontab定时任务

-l 查询crontab任务

-r 删除当前用户所有的crontab任务

### * * * * * 执行的任务，*的含义

| **第一个“\***” | **一小时当中的第几分钟** | **0-59**                |
| -------------- | ------------------------ | ----------------------- |
| **第二个“\***” | 一天当中的第几小时       | 0-23                    |
| **第三个“\***” | 一个月当中的第几天       | 1-31                    |
| **第四个“\***” | 一年当中的第几月         | 1-12                    |
| **第五个“\***” | 一周当中的星期几         | 0-7（0和7都代表星期日） |

| **特殊符号** | **含义**                                                     |
| ------------ | ------------------------------------------------------------ |
| *****        | 代表任何时间。比如第一个“*”就代表一小时中每分钟都执行一次的意思。 |
| **，**       | 代表不连续的时间。比如“0 8,12,16 * * * 命令”，就代表在每天的8点0分，12点0分，16点0分都执行一次命令 |
| **-**        | 代表连续的时间范围。比如“0  5 *   * 1-6命令”，代表在周一到周六的凌晨5点0分执行命令 |
| ***/n**      | 代表每隔多久执行一次。比如“*/10   * * *   * 命令”，代表每隔10分钟就执行一遍命令 |

# RPM查询命令

rpm -qa            （功能描述：查询所安装的所有rpm软件包）

# RPM卸载命令

rpm -e RPM软件包  

rpm -e --nodeps 软件包 

| **-e**       | **卸载软件包**                                               |
| ------------ | ------------------------------------------------------------ |
| **--nodeps** | 卸载软件时，不检查依赖。这样的话，那些使用该软件包的软件在此之后可能就不能正常工作了。 |

# RPM安装命令

rpm -ivh RPM包全名

| **选项**     | **功能**                 |
| ------------ | ------------------------ |
| **-i**       | -i=install，安装         |
| **-v**       | -v=verbose，显示详细信息 |
| **-h**       | -h=hash，进度条          |
| **--nodeps** | --nodeps，不检测依赖进度 |

# YUM的常用命令

yum [选项] [参数]

| **选项** | **功能**              |
| -------- | --------------------- |
| **-y**   | 对所有提问都回答“yes” |

| **参数**         | **功能**                           |
| ---------------- | ---------------------------------- |
| **install**      | 安装rpm软件包                      |
| **update**       | 更新rpm软件包                      |
| **check-update** | 检查是否有可用的更新rpm软件包      |
| **remove**       | 删除指定的rpm软件包                |
| **list**         | 显示软件包信息                     |
| **clean all**    | 清理yum过期的缓存                  |
| **makecache**    | 将当前yum源里的rpm包列表缓存到本地 |
| **deplist**      | 显示yum软件包的所有依赖关系        |

# 修改网络YUM源

yum install wget

mv CentOS-Base.repo  CentOS-Base.repo.backup

 wget http://mirrors.aliyun.com/repo/Centos-7.repo //阿里云

或

wgethttp://mirrors.163.com/.help/CentOS7-Base-163.repo //网易163 

(如下载不成功可以在Window上下载完copy到linux)

把新下载的改名mv  Centos-7.repo CentOS-Base.repo

yum clean all

yum makecache

# scp（secure copy）安全拷贝

scp   -r         $pdir/$fname                          $user@$host:$pdir/$fname

命令  递归   要拷贝的文件路径/名称  目的地用户@主机:目的地路径/名称

# **rsync**远程同步工具

rsync    -av          $pdir/$fname                          $user@$host:$pdir/$fname

命令  选项参数  要拷贝的文件路径/名称  目的地用户@主机:目的地路径/名称

| **选项** | **功能**     |
| -------- | ------------ |
| **-a**   | 归档拷贝     |
| **-v**   | 显示复制过程 |

# copy脚本:xsync

```shell
#!/bin/bash

#1. 判断参数个数
if [ $# -lt 1 ]
then
    echo Not Enough Arguement!
    exit;
fi

#2. 遍历集群所有机器
for host in hadoop102 hadoop103 hadoop104
do
    echo ====================  $host  ====================
    #3. 遍历所有目录，挨个发送
    for file in $@
    do
        #4. 判断文件是否存在
        if [ -e $file ]
            then
                #5. 获取父目录
                pdir=$(cd -P $(dirname $file); pwd)

                #6. 获取当前文件的名称
                fname=$(basename $file)
                ssh $host "mkdir -p $pdir"
                rsync -av $pdir/$fname $host:$pdir
            else
                echo $file does not exists!
        fi
    done
done

```

修改脚本 xsync 具有执行权限

chmod +x xsync

